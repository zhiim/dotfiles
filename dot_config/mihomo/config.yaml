######### é”šç‚¹ start #######
# ç­–ç•¥ç»„ç›¸å…³
pr: &pr
  type: select
  proxies:
    [
      ğŸ¥¤ é»˜è®¤,
      ğŸ‡­ğŸ‡° é¦™æ¸¯,
      ğŸ‡¹ğŸ‡¼ å°æ¹¾,
      ğŸ‡¯ğŸ‡µ æ—¥æœ¬,
      ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡,
      ğŸ‡ºğŸ‡¸ ç¾å›½,
      ğŸŒ å…¶å®ƒåœ°åŒº,
      ğŸš€ å…¨éƒ¨èŠ‚ç‚¹,
      â™» è‡ªåŠ¨é€‰æ‹©,
      ğŸ¯ ç›´è¿,
    ]

#è¿™é‡Œæ˜¯è®¢é˜…æ›´æ–°å’Œå»¶è¿Ÿæµ‹è¯•ç›¸å…³çš„
p: &p
  type: http
  interval: 21600
  health-check:
    enable: true
    url: https://www.gstatic.com/generate_204
    interval: 3600
######### é”šç‚¹ end #######

# url é‡Œå¡«å†™è‡ªå·±çš„è®¢é˜…,åç§°ä¸èƒ½é‡å¤
proxy-providers:
  provider:
    <<: *p
    url: ""

ipv6: true
mode: rule
log-level: info
allow-lan: true
mixed-port: 7890
unified-delay: false # è®¡ç®—å»¶è¿Ÿæ—¶æ˜¯å¦å»é™¤æ¡æ‰‹ç­‰é¢å¤–å¼€é”€
tcp-concurrent: true
external-controller: 127.0.0.1:9090
external-ui: ui # å‰ç«¯è·¯å¾„/path/to/clash/config/ui
external-ui-url: "https://github.com/MetaCubeX/metacubexd/archive/refs/heads/gh-pages.zip"

geodata-mode: true
# è‡ªå®šä¹‰GEOä¸‹è½½åœ°å€, å¯ç”¨cdnåŠ é€Ÿä¸‹è½½
geox-url:
  geoip: "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/geoip.dat"
  geosite: "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/geosite.dat"
  mmdb: "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/country.mmdb"

find-process-mode: strict
global-client-fingerprint: chrome

profile:
  store-selected: true # ä¿å­˜APIæ§åˆ¶çš„æ›´æ”¹
  store-fake-ip: true

sniffer:
  enable: true
  sniff:
    HTTP:
      ports: [80, 8080-8880]
      override-destination: true
    TLS:
      ports: [443, 8443]
    QUIC:
      ports: [443, 8443]
  skip-domain:
    - "Mijia Cloud"

## tunèµ‹æƒ  ##
# Linux: sudo setcap cap_net_bind_service,cap_net_admin=+ep /path/to/clash
# ref: https://github.com/zzzgydi/clash-verge/issues/182
#
# Windows: ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ
## tunèµ‹æƒ  ##
tun:
  enable: false # é»˜è®¤å…³é—­
  device: utun0
  inet6-address:
  stack: mixed
  dns-hijack:
    - "any:53"
  auto-route: true
  auto-detect-interface: true

dns:
  enable: true
  listen: :1053
  ipv6: true
  enhanced-mode: fake-ip
  fake-ip-range: 28.0.0.1/8 # clash ä»¥æ­¤IPæ®µå‘é€fakeipæ˜ å°„
  fake-ip-filter: # ä»¥ä¸‹åœ°å€ä¸ä½¿ç”¨fakeip
    - "*"
    - "+.lan"
    - "+.local"
  default-nameserver: # ç”¨äºè§£æDNSæœåŠ¡å™¨, å¿…é¡»ä¸ºIP
    - 223.5.5.5 # é˜¿é‡Œ
    - 119.29.29.29 # è…¾è®¯
    - 8.8.8.8 # Google
  proxy-server-nameserver: # ç”¨äºè§£æä»£ç†èŠ‚ç‚¹çš„åŸŸå
    - https://doh.pub/dns-query
    - 223.5.5.5
    - 8.8.8.8
    - 208.67.222.222 # opendns
  nameserver: # åŸŸåè§£æ
    - https://doh.pub/dns-query # è…¾è®¯doh
    - https://dns.alidns.com/dns-query # é˜¿é‡Œdoh
  fallback: # ç”¨äºè§£æfallback-filteråŒ¹é…çš„åŸŸå
    - "8.8.8.8"
    - "208.67.222.222"
    - "tls://dns.google"
    - "https://doh.opendns.com/dns-query"
  fallback-filter:
    geoip: true
    geoip-code: CN # CN çš„IPç›´æ¥é‡‡ç”¨, å…¶ä½™é‡‡ç”¨fallbackçš„ç»“æœ
    ipcidr: [240.0.0.0/4]
    domain:
      [
        +.google.com,
        +.facebook.com,
        +.twitter.com,
        +.youtube.com,
        +.xn--ngstr-lra8j.com,
        +.google.cn,
        +.googleapis.cn,
        +.googleapis.com,
        +.gvt1.com,
      ]

proxies:
  - name: "ğŸ¯ ç›´è¿"
    type: direct
    udp: true

proxy-groups:
  - {
      name: ğŸ¥¤ é»˜è®¤,
      type: select,
      proxies:
        [
          â™» è‡ªåŠ¨é€‰æ‹©,
          ğŸ¯ ç›´è¿,
          ğŸ‡­ğŸ‡° é¦™æ¸¯,
          ğŸ‡¹ğŸ‡¼ å°æ¹¾,
          ğŸ‡¯ğŸ‡µ æ—¥æœ¬,
          ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡,
          ğŸ‡ºğŸ‡¸ ç¾å›½,
          ğŸŒ å…¶å®ƒåœ°åŒº,
          ğŸš€ å…¨éƒ¨èŠ‚ç‚¹,
        ],
    }
  - { name: ğŸš€ å…¨éƒ¨èŠ‚ç‚¹, type: select, include-all-providers: true }
  - { name: ğŸ§Š Google, <<: *pr }
  - { name: ğŸ­ Telegram, <<: *pr }
  - { name: ğŸ¦ Twitter, <<: *pr }
  - { name: ğŸ¡ Pixiv, <<: *pr }
  - { name: ğŸ«— å“”å“©å“”å“©, <<: *pr }
  - { name: ğŸ¥ƒ å“”å“©ä¸œå—äºš, <<: *pr }
  - { name: ğŸ§ƒ å·´å“ˆå§†ç‰¹, <<: *pr }
  - { name: ğŸ§‹ YouTube, <<: *pr }
  - { name: ğŸ«™ NETFLIX, <<: *pr }
  - { name: ğŸ¥› Spotify, <<: *pr }
  - { name: ğŸ® Github, <<: *pr }
  - { name: ğŸ“¢ è°·æ­ŒFCM, <<: *pr }
  - {
      name: ğŸ‡¨ğŸ‡³ å›½å†…,
      type: select,
      proxies:
        [
          ğŸ¯ ç›´è¿,
          ğŸ¥¤ é»˜è®¤,
          ğŸ‡­ğŸ‡° é¦™æ¸¯,
          ğŸ‡¹ğŸ‡¼ å°æ¹¾,
          ğŸ‡¯ğŸ‡µ æ—¥æœ¬,
          ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡,
          ğŸ‡ºğŸ‡¸ ç¾å›½,
          ğŸŒ å…¶å®ƒåœ°åŒº,
          ğŸš€ å…¨éƒ¨èŠ‚ç‚¹,
          â™» è‡ªåŠ¨é€‰æ‹©,
        ],
    }
  - { name: â­ å…¶ä»–éå¤§é™†, <<: *pr }
  - { name: ğŸŸ æ¼ç½‘ä¹‹é±¼, <<: *pr }

  #åˆ†éš”,ä¸‹é¢æ˜¯åœ°åŒºåˆ†ç»„
  - {
      name: ğŸ‡­ğŸ‡° é¦™æ¸¯,
      type: select,
      include-all-providers: true,
      filter: "(?i)æ¸¯|hk|hongkong|hong kong",
    }
  - {
      name: ğŸ‡¹ğŸ‡¼ å°æ¹¾,
      type: select,
      include-all-providers: true,
      filter: "(?i)å°|tw|taiwan",
    }
  - {
      name: ğŸ‡¯ğŸ‡µ æ—¥æœ¬,
      type: select,
      include-all-providers: true,
      filter: "(?i)æ—¥|jp|japan",
    }
  - {
      name: ğŸ‡°ğŸ‡· éŸ©å›½,
      type: select,
      include-all-providers: true,
      filter: "(?i)éŸ©|kr|korea",
    }
  - {
      name: ğŸ‡ºğŸ‡¸ ç¾å›½,
      type: select,
      include-all-providers: true,
      filter: "(?i)ç¾|us|unitedstates|united states",
    }
  - {
      name: ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡,
      type: select,
      include-all-providers: true,
      filter: "(?i)(æ–°|sg|singapore)",
    }
  - {
      name: ğŸŒ å…¶å®ƒåœ°åŒº,
      type: select,
      include-all-providers: true,
      filter: "(?i)^(?!.*(?:ğŸ‡­ğŸ‡°|ğŸ‡¯ğŸ‡µ|ğŸ‡ºğŸ‡¸|ğŸ‡¸ğŸ‡¬|ğŸ‡¨ğŸ‡³|æ¸¯|hk|hongkong|å°|tw|taiwan|æ—¥|jp|japan|æ–°|sg|singapore|ç¾|us|unitedstates)).*",
    }
  - {
      name: â™» è‡ªåŠ¨é€‰æ‹©,
      type: url-test,
      include-all-providers: true,
      tolerance: 10,
    }

rules:
  # è‡ªå®šä¹‰è§„åˆ™
  - DOMAIN-KEYWORD,porn,REJECT
  - DOMAIN-KEYWORD,jav,REJECT
  - DOMAIN-KEYWORD,missav,REJECT
  - DOMAIN-KEYWORD,sex,REJECT
  - DOMAIN-KEYWORD,xvideos,REJECT
  - DOMAIN-SUFFIX,madou.club,REJECT
  - DOMAIN-SUFFIX,wnacg.org,REJECT
  - DOMAIN-SUFFIX,xhamster.com,REJECT
  - DOMAIN-SUFFIX,xnxx.com,REJECT
  - DOMAIN-SUFFIX,rou.video,REJECT
  - RULE-SET,porn_domain,REJECT
  - DOMAIN-SUFFIX,x.com,REJECT
  - DOMAIN-KEYWORD,91cg,REJECT
  - DOMAIN-KEYWORD,51cg,REJECT
  - DOMAIN-KEYWORD,cg51,REJECT
  - DOMAIN-KEYWORD,cg91,REJECT
  - DOMAIN-KEYWORD,cgw,REJECT
  - DOMAIN-KEYWORD,51gua,REJECT
  - DOMAIN-KEYWORD,91gua,REJECT
  - DOMAIN-KEYWORD,gua51,REJECT
  - DOMAIN-KEYWORD,gua91,REJECT

  # åŸŸåè§„åˆ™
  - GEOIP,lan,ğŸ¯ ç›´è¿,no-resolve
  - RULE-SET,biliintl_domain,ğŸ¥ƒ å“”å“©ä¸œå—äºš
  - RULE-SET,github_domain,ğŸ® Github
  - RULE-SET,twitter_domain,ğŸ¦ Twitter
  - RULE-SET,youtube_domain,ğŸ§‹ YouTube
  - RULE-SET,google_domain,ğŸ§Š Google
  - RULE-SET,telegram_domain,ğŸ­ Telegram
  - RULE-SET,netflix_domain,ğŸ«™ NETFLIX
  - RULE-SET,bilibili_domain,ğŸ«— å“”å“©å“”å“©
  - RULE-SET,bahamut_domain,ğŸ§ƒ å·´å“ˆå§†ç‰¹
  - RULE-SET,spotify_domain,ğŸ¥› Spotify
  - RULE-SET,pixiv_domain,ğŸ¡ Pixiv
  - RULE-SET,geolocation-!cn,â­ å…¶ä»–éå¤§é™†

  # IPè§„åˆ™, å¦‚æœåŸŸåè§„åˆ™ä¸åŒ¹é…åˆ™è¿›å…¥IPè§„åˆ™, æ­¤æ—¶ä¼šä½¿ç”¨Clashé…ç½®çš„DNSè§„åˆ™è§£æIP
  - RULE-SET,google_ip,ğŸ§Š Google
  - RULE-SET,netflix_ip,ğŸ«™ NETFLIX
  - RULE-SET,telegram_ip,ğŸ­ Telegram
  - RULE-SET,twitter_ip,ğŸ¦ Twitter
  - RULE-SET,cn_domain,ğŸ‡¨ğŸ‡³ å›½å†…
  - RULE-SET,cn_ip,ğŸ‡¨ğŸ‡³ å›½å†…
  - MATCH,ğŸŸ æ¼ç½‘ä¹‹é±¼

  # google fcm used in android
  - DOMAIN,alt1-mtalk.google.com,ğŸ“¢ è°·æ­ŒFCM
  - DOMAIN,alt2-mtalk.google.com,ğŸ“¢ è°·æ­ŒFCM
  - DOMAIN,alt3-mtalk.google.com,ğŸ“¢ è°·æ­ŒFCM
  - DOMAIN,alt4-mtalk.google.com,ğŸ“¢ è°·æ­ŒFCM
  - DOMAIN,alt5-mtalk.google.com,ğŸ“¢ è°·æ­ŒFCM
  - DOMAIN,alt6-mtalk.google.com,ğŸ“¢ è°·æ­ŒFCM
  - DOMAIN,alt7-mtalk.google.com,ğŸ“¢ è°·æ­ŒFCM
  - DOMAIN,alt8-mtalk.google.com,ğŸ“¢ è°·æ­ŒFCM
  - DOMAIN,mtalk.google.com,ğŸ“¢ è°·æ­ŒFCM
  - IP-CIDR,64.233.177.188/32,ğŸ“¢ è°·æ­ŒFCM,no-resolve
  - IP-CIDR,64.233.186.188/32,ğŸ“¢ è°·æ­ŒFCM,no-resolve
  - IP-CIDR,64.233.187.188/32,ğŸ“¢ è°·æ­ŒFCM,no-resolve
  - IP-CIDR,64.233.188.188/32,ğŸ“¢ è°·æ­ŒFCM,no-resolve
  - IP-CIDR,64.233.189.188/32,ğŸ“¢ è°·æ­ŒFCM,no-resolve
  - IP-CIDR,74.125.23.188/32,ğŸ“¢ è°·æ­ŒFCM,no-resolve
  - IP-CIDR,74.125.24.188/32,ğŸ“¢ è°·æ­ŒFCM,no-resolve
  - IP-CIDR,74.125.28.188/32,ğŸ“¢ è°·æ­ŒFCM,no-resolve
  - IP-CIDR,74.125.127.188/32,ğŸ“¢ è°·æ­ŒFCM,no-resolve
  - IP-CIDR,74.125.137.188/32,ğŸ“¢ è°·æ­ŒFCM,no-resolve
  - IP-CIDR,74.125.203.188/32,ğŸ“¢ è°·æ­ŒFCM,no-resolve
  - IP-CIDR,74.125.204.188/32,ğŸ“¢ è°·æ­ŒFCM,no-resolve
  - IP-CIDR,74.125.206.188/32,ğŸ“¢ è°·æ­ŒFCM,no-resolve
  - IP-CIDR,108.177.125.188/32,ğŸ“¢ è°·æ­ŒFCM,no-resolve
  - IP-CIDR,142.250.4.188/32,ğŸ“¢ è°·æ­ŒFCM,no-resolve
  - IP-CIDR,142.250.10.188/32,ğŸ“¢ è°·æ­ŒFCM,no-resolve
  - IP-CIDR,142.250.31.188/32,ğŸ“¢ è°·æ­ŒFCM,no-resolve
  - IP-CIDR,142.250.96.188/32,ğŸ“¢ è°·æ­ŒFCM,no-resolve
  - IP-CIDR,172.217.194.188/32,ğŸ“¢ è°·æ­ŒFCM,no-resolve
  - IP-CIDR,172.217.218.188/32,ğŸ“¢ è°·æ­ŒFCM,no-resolve
  - IP-CIDR,172.217.219.188/32,ğŸ“¢ è°·æ­ŒFCM,no-resolve
  - IP-CIDR,172.253.63.188/32,ğŸ“¢ è°·æ­ŒFCM,no-resolve
  - IP-CIDR,172.253.122.188/32,ğŸ“¢ è°·æ­ŒFCM,no-resolve
  - IP-CIDR,173.194.175.188/32,ğŸ“¢ è°·æ­ŒFCM,no-resolve
  - IP-CIDR,173.194.218.188/32,ğŸ“¢ è°·æ­ŒFCM,no-resolve
  - IP-CIDR,209.85.233.188/32,ğŸ“¢ è°·æ­ŒFCM,no-resolve

## è§„åˆ™é”šç‚¹ ##
ip: &ip
  type: http
  interval: 86400
  behavior: ipcidr
  format: yaml
domain: &domain
  type: http
  interval: 86400
  behavior: domain
  format: yaml

rule-providers:
  porn_domain:
    <<: *domain
    url: "https://raw.githubusercontent.com/1stfine/open_clash/master/rule_provider/rule_porn.yaml"
  cn_domain:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/cn.yaml"
  biliintl_domain:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/biliintl.yaml"
  github_domain:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/github.yaml"
  twitter_domain:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/twitter.yaml"
  youtube_domain:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/youtube.yaml"
  google_domain:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/google.yaml"
  telegram_domain:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/telegram.yaml"
  netflix_domain:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/netflix.yaml"
  bilibili_domain:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/bilibili.yaml"
  bahamut_domain:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/bahamut.yaml"
  spotify_domain:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/spotify.yaml"
  pixiv_domain:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/pixiv.yaml"
  geolocation-!cn:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/geolocation-!cn.yaml"

  cn_ip:
    <<: *ip
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/cn.yaml"
  google_ip:
    <<: *ip
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/google.yaml"
  netflix_ip:
    <<: *ip
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/netflix.yaml"
  twitter_ip:
    <<: *ip
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/twitter.yaml"
  telegram_ip:
    <<: *ip
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/telegram.yaml"
